<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/assets/css/reviews.css}">
</head>
<body>

<!-- Review Section Fragment -->
<div th:fragment="reviewSection" class="review-section">

    <!-- Rating Summary -->
    <div id="ratingSummary" class="mb-4">
        <!-- Will be populated by JavaScript -->
        <div class="rating-summary">
            <div class="rating-summary__score">
                <h2 class="rating-summary__number">0.0</h2>
                <div class="rating-summary__stars">
                    <img th:src="@{/assets/icon/blank-star.svg}" alt="star" class="star-icon"/>
                    <img th:src="@{/assets/icon/blank-star.svg}" alt="star" class="star-icon"/>
                    <img th:src="@{/assets/icon/blank-star.svg}" alt="star" class="star-icon"/>
                    <img th:src="@{/assets/icon/blank-star.svg}" alt="star" class="star-icon"/>
                    <img th:src="@{/assets/icon/blank-star.svg}" alt="star" class="star-icon"/>
                </div>
                <p class="rating-summary__text">0 đánh giá</p>
            </div>
            <div class="rating-summary__bars">
                <div class="rating-bar">
                    <span class="rating-bar__label">5 sao</span>
                    <div class="rating-bar__track">
                        <div class="rating-bar__fill" style="width: 0%"></div>
                    </div>
                    <span class="rating-bar__count">0</span>
                </div>
                <div class="rating-bar">
                    <span class="rating-bar__label">4 sao</span>
                    <div class="rating-bar__track">
                        <div class="rating-bar__fill" style="width: 0%"></div>
                    </div>
                    <span class="rating-bar__count">0</span>
                </div>
                <div class="rating-bar">
                    <span class="rating-bar__label">3 sao</span>
                    <div class="rating-bar__track">
                        <div class="rating-bar__fill" style="width: 0%"></div>
                    </div>
                    <span class="rating-bar__count">0</span>
                </div>
                <div class="rating-bar">
                    <span class="rating-bar__label">2 sao</span>
                    <div class="rating-bar__track">
                        <div class="rating-bar__fill" style="width: 0%"></div>
                    </div>
                    <span class="rating-bar__count">0</span>
                </div>
                <div class="rating-bar">
                    <span class="rating-bar__label">1 sao</span>
                    <div class="rating-bar__track">
                        <div class="rating-bar__fill" style="width: 0%"></div>
                    </div>
                    <span class="rating-bar__count">0</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Review Form -->
    <div id="reviewFormContainer" class="mb-4">
        <div class="review-form">
            <h3 class="review-form__title">Viết đánh giá của bạn</h3>
            <form id="reviewForm">
                <!-- Rating -->
                <div class="review-form__group">
                    <label class="review-form__label review-form__label--required">
                        Đánh giá của bạn
                    </label>
                    <div class="star-rating">
                        <img th:src="@{/assets/icon/star.svg}" alt="1 star" class="star-rating__star"/>
                        <img th:src="@{/assets/icon/star.svg}" alt="2 stars" class="star-rating__star"/>
                        <img th:src="@{/assets/icon/star.svg}" alt="3 stars" class="star-rating__star"/>
                        <img th:src="@{/assets/icon/star.svg}" alt="4 stars" class="star-rating__star"/>
                        <img th:src="@{/assets/icon/star.svg}" alt="5 stars" class="star-rating__star"/>
                    </div>
                    <input type="hidden" id="ratingInput" name="rating" required/>
                </div>

                <!-- Title -->
                <div class="review-form__group">
                    <label for="reviewTitle" class="review-form__label">
                        Tiêu đề (tùy chọn)
                    </label>
                    <input
                            type="text"
                            id="reviewTitle"
                            name="title"
                            class="review-form__input"
                            placeholder="Tóm tắt đánh giá của bạn"
                            maxlength="200"
                    />
                </div>

                <!-- Comment -->
                <div class="review-form__group">
                    <label for="reviewComment" class="review-form__label">
                        Nội dung đánh giá (tùy chọn)
                    </label>
                    <textarea
                            id="reviewComment"
                            name="comment"
                            class="review-form__textarea"
                            placeholder="Chia sẻ trải nghiệm của bạn về sản phẩm này..."
                            maxlength="2000"
                    ></textarea>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="review-form__submit">
                    Gửi đánh giá
                </button>
            </form>
        </div>
    </div>

    <!-- Reviews List -->
    <div class="mb-4">
        <h3 class="mb-3">Đánh giá từ khách hàng</h3>
        <div id="reviewsList">
            <!-- Will be populated by JavaScript -->
            <div class="text-center py-4">
                <p>Đang tải đánh giá...</p>
            </div>
        </div>
    </div>

    <!-- Pagination -->
    <div id="reviewsPagination">
        <!-- Will be populated by JavaScript -->
    </div>

</div>

<!-- Compact Review Display (for product cards) -->
<div th:fragment="compactRating(rating, reviewCount)" class="compact-rating">
    <div class="compact-rating__stars">
        <th:block th:each="i : ${#numbers.sequence(1, 5)}">
            <img th:if="${i <= rating}"
                 th:src="@{/assets/icon/star.svg}"
                 alt="star"
                 class="star-icon"/>
            <img th:if="${i > rating && i - rating < 1}"
                 th:src="@{/assets/icon/half-star.svg}"
                 alt="half star"
                 class="star-icon"/>
            <img th:if="${i > rating && i - rating >= 1}"
                 th:src="@{/assets/icon/blank-star.svg}"
                 alt="empty star"
                 class="star-icon"/>
        </th:block>
    </div>
    <span class="compact-rating__text" th:text="${'(' + rating + ') ' + reviewCount + ' đánh giá'}">
        (0.0) 0 đánh giá
    </span>
</div>

</body>
</html>
